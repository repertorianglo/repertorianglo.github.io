---
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';
import PostCard from '../../../../components/PostCard.astro';
import FormattedDate from '../../../../components/FormattedDate.astro';
import EixosTematico from '../../../../layouts/EixosTematico.astro';
import { grupos } from '../../../../common/pessoas';

const eixos = (await getCollection('eixosTematicos'));
const eixo = eixos.find(e => e.id === '4-saude-e-ciencia');
const posts = await getCollection('saude-e-ciencia');

// Import hero images for each post
const postsWithHeroImages = await Promise.all(
	posts.map(async (post) => {
		let heroImage;
        console.log(`../../../../assets/eixos-tematicos/saude-e-ciencia/${post.id}/hero.png`)
		try {
			heroImage = await import(`../../../../assets/eixos-tematicos/saude-e-ciencia/${post.id}/hero.png`);
		} catch (error) {
			console.warn(`Hero image not found for post: ${post.id}`);
		}
		return { ...post, heroImage };
	})
);

---
{eixo && (
	<EixosTematico eixo={eixo.data}>
            {postsWithHeroImages.map(item => (
                <PostCard
                    href={`/blog/eixos-tematicos/saude-e-ciencia/posts/${item.id}`}
                    heroImage={item.heroImage}
                    data={item.data}
                    grupos={grupos}
                />
            ))}
    </EixosTematico>
)}
